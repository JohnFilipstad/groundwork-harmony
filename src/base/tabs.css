/**
 * @file
 * Modern, accessible visual styles for tabs using design tokens.
 */

/* Tab Navigation Container */
.tabs {
  margin: var(--spacing-m) 0;
  border-bottom: var(--border-width-thin) solid var(--border-color-default);
  position: relative;
}

/* Tab List */
.tabs ul {
  margin: 0;
  padding: 0;
  list-style: none;
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-xs);
  position: relative;
}

/* RTL Support for Tab List */
[dir="rtl"] .tabs ul {
  direction: rtl;
}

/* Individual Tab Items */
.tabs > ul > li {
  display: flex;
  margin: 0;
  position: relative;
}

/* Tab Links */
.tabs a {
  display: flex;
  align-items: center;
  padding: var(--spacing-s) var(--spacing-l);
  min-height: 44px; /* WCAG minimum touch target */
  font-family: var(--font-family-base), "Groundwork Serif", serif;
  font-size: var(--font-size-m);
  font-weight: var(--font-weight-medium);
  line-height: var(--line-height-tight);
  text-decoration: none;
  color: var(--color-text-base);
  background-color: transparent;
  border: var(--border-width-thin) solid transparent;
  border-bottom: none;
  border-radius: var(--border-radius-s) var(--border-radius-s) 0 0;
  position: relative;
  transition: var(--transition-colors), var(--transition-transform);
  cursor: pointer;
  white-space: nowrap;
}

/* Hover State */
.tabs a:hover:not(.is-active) {
  color: var(--color-primary);
  background-color: color-mix(in oklab, var(--color-primary) 8%, transparent);
  border-color: color-mix(in oklab, var(--color-primary) 20%, transparent);
  transform: translateY(-1px);
}

/* Focus State */
.tabs a:focus {
  outline: var(--border-width-m) solid var(--border-color-focus);
  outline-offset: var(--border-width-thin);
  z-index: var(--z-index-elevated);
}

/* Active State */
.tabs a.is-active {
  color: var(--color-primary);
  background-color: var(--background-color-body);
  border-color: var(--border-color-default);
  border-bottom-color: transparent; /* Remove bottom border for connected feel */
  font-weight: var(--font-weight-semibold);
  z-index: var(--z-index-base);
  position: relative;
  margin-bottom: -1px; /* Pull down to cover .tabs border-bottom */
}

/* Active state bottom border override for seamless connection */
.tabs a.is-active::after {
  content: '';
  position: absolute;
  bottom: -1px;
  left: 0;
  right: 0;
  height: var(--border-width-thin);
  background-color: var(--background-color-body);
  z-index: var(--z-index-base);
}

/* Active state visual indicator - purple line at top */
.tabs a.is-active::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background-color: var(--color-primary);
  border-radius: 0 0 var(--border-radius-xs) var(--border-radius-xs);
  z-index: var(--z-index-elevated);
}

/* Disabled State */
.tabs a:disabled,
.tabs a[aria-disabled="true"] {
  color: var(--color-text-base-disabled);
  background-color: var(--background-color-disabled);
  cursor: not-allowed;
  pointer-events: none;
}

/* Primary Tabs Specific Styling */
.tabs.primary ul {
  border-bottom: none;
}

/* Secondary Tabs */
.tabs.secondary {
  margin-top: var(--spacing-s);
  border-bottom: var(--border-width-thin) solid color-mix(in oklab, var(--border-color-default) 50%, transparent);
}

.tabs.secondary ul {
  gap: var(--spacing-xs);
}

.tabs.secondary a {
  padding: var(--spacing-xs) var(--spacing-m);
  font-size: var(--font-size-s);
  font-weight: var(--font-weight-normal);
  border-radius: var(--border-radius-xs);
  border: var(--border-width-thin) solid var(--border-color-default);
}

.tabs.secondary a:hover:not(.is-active) {
  background-color: var(--background-color-surface-light);
  transform: none;
}

.tabs.secondary a.is-active {
  background-color: var(--color-primary);
  color: var(--color-text-base-inverse);
  border-color: var(--color-primary);
}

.tabs.secondary a.is-active::before,
.tabs.secondary a.is-active::after {
  display: none;
}

/* Icon Support in Tabs */
.tabs a .tab-icon {
  margin-right: var(--spacing-xs); /* LTR */
  width: var(--icon-size-s);
  height: var(--icon-size-s);
  flex-shrink: 0;
}

/* RTL Support for Tab Icons */
[dir="rtl"] .tabs a .tab-icon {
  margin-right: 0;
  margin-left: var(--spacing-xs);
}

/* Responsive Design */
@media (max-width: 768px) {
  .tabs ul {
    flex-direction: column;
    gap: var(--spacing-xs);
  }

  .tabs > ul > li {
    flex: 1;
  }

  .tabs a {
    justify-content: center;
    border-radius: var(--border-radius-s);
    border: var(--border-width-thin) solid var(--border-color-default);
  }

  .tabs a.is-active {
    border-color: var(--color-primary);
  }

  .tabs a.is-active::before {
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    border-radius: 0 0 var(--border-radius-xs) var(--border-radius-xs);
  }

  /* Mobile: Keep bottom border removal for connection */
  .tabs a.is-active {
    border-bottom-color: transparent;
  }

  .tabs a.is-active::after {
    display: none;
  }
}

/* High Contrast Mode Support */
@media (prefers-contrast: more) {
  .tabs a {
    border-color: var(--color-text-base);
  }

  .tabs a:hover:not(.is-active) {
    background-color: var(--color-text-base);
    color: var(--background-color-body);
  }

  .tabs a.is-active {
    border-color: var(--color-primary);
    border-width: var(--border-width-m);
  }
}

/* Reduced Motion Support */
@media (prefers-reduced-motion: reduce) {
  .tabs a {
    transition: none;
  }

  .tabs a:hover:not(.is-active) {
    transform: none;
  }
}

/* Dropdown/Overflow Support for Many Tabs */
.tabs-overflow {
  position: relative;
}

.tabs-overflow-button {
  display: none;
  align-items: center;
  padding: var(--spacing-s) var(--spacing-m);
  background: var(--background-color-surface-light);
  border: var(--border-width-thin) solid var(--border-color-default);
  border-radius: var(--border-radius-s);
  cursor: pointer;
  font-size: var(--font-size-s);
  color: var(--color-text-base);
  margin-left: var(--spacing-xs); /* LTR */
}

/* RTL Support for Overflow Button */
[dir="rtl"] .tabs-overflow-button {
  margin-left: 0;
  margin-right: var(--spacing-xs);
}

.tabs-overflow-button:hover {
  background-color: var(--background-color-surface-hover);
}

.tabs-overflow-button::after {
  content: 'â–¼';
  margin-left: var(--spacing-xs); /* LTR */
  font-size: 0.8em;
}

/* RTL Support for Overflow Button Arrow */
[dir="rtl"] .tabs-overflow-button::after {
  margin-left: 0;
  margin-right: var(--spacing-xs);
}

/* Focus Visible Enhancement */
@supports selector(:focus-visible) {
  .tabs a:focus {
    outline: none;
  }

  .tabs a:focus-visible {
    outline: var(--border-width-m) solid var(--border-color-focus);
    outline-offset: var(--border-width-thin);
  }
}
